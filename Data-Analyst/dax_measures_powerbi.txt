// ============================
// POWER BI DAX MEASURES PACK
// (Create three models or one combined with separate tables)
// ============================

/* SALES / PROFITABILITY (Executive Overview) */
Total Sales = SUM('Sales'[Sales])
Total Profit = SUM('Sales'[Profit])
Profit Ratio = DIVIDE([Total Profit],[Total Sales])

Total Quantity = SUM('Sales'[Quantity])
Avg Discount = AVERAGE('Sales'[Discount])

Profit per Order =
DIVIDE([Total Profit], DISTINCTCOUNT('Sales'[Order ID]))

Sales per Customer =
DIVIDE([Total Sales], DISTINCTCOUNT('Customers'[Customer ID]))

/* NETFLIX CONTENT */
Total Titles = DISTINCTCOUNT('Netflix'[show_id])

Movies Count =
CALCULATE([Total Titles], 'Netflix'[type] = "Movie")

TV Shows Count =
CALCULATE([Total Titles], 'Netflix'[type] = "TV Show")

% Movies = DIVIDE([Movies Count],[Total Titles])
% TV Shows = DIVIDE([TV Shows Count],[Total Titles])

/* RATINGS DISTRIBUTION uses: Rating on axis + [Total Titles] */
Titles by Release Year = [Total Titles]

Titles Added =
CALCULATE(
  [Total Titles],
  USERELATIONSHIP('Netflix'[date_added_parsed], 'Date'[Date])
)

/* TRAFFIC */
Total Traffic Volume = SUM('Traffic'[traffic_volume])

Avg Traffic per Hour =
AVERAGEX(VALUES('Traffic'[hour]), CALCULATE([Total Traffic Volume]))

Holiday Traffic =
CALCULATE([Total Traffic Volume], 'Traffic'[holiday] <> "None")

Non-Holiday Traffic =
CALCULATE([Total Traffic Volume], 'Traffic'[holiday] = "None")